# Документация к коду приложения #

## Ссылки ##

+ Скачать приложение - https://github.com/EgorkaSQL/LED_strip/blob/main/app-debug.apk
+ Java файлы - https://github.com/EgorkaSQL/LED_strip/tree/main/main/java/com/example/projectiapi
+ xml файлы - https://github.com/EgorkaSQL/LED_strip/tree/main/main/res

## MenuDialog.java ##

Данный класс предназначен для отдельного всплывающего меню "Цвета" - dialog_menu.xml.\
В нем присутствуют слайдер для регулирования яркости и 6 цветов:
+ Синий
+ Красный
+ Зеленый
+ Синий и красный
+ Синий и зеленый
+ Красный и зелеый

Класс состоит из следующих классов:
+ MenuDialog - конструктор класса
+ setOutputStream - устанавливает новый OutputStream и используется для смены или же обновления Bluetooth соединения
+ showMenuDialog - Основной метод для отображения в виде диалога BottomSheet. Основные действия:
  + Создает и конфигурирует BottomSheetDialog
  + Инициализирует элементы интерфейса
  + Настраивает обработчики событий для кнопок и слайдера
  + Управляет состоянием диалога через BottomSheetBehavior
+ setupColorButton - метод для конфигурации цветных кнопок. Выполняет следующее:
  + Считывает сохранение состояние кнопки из SharedPreferences
  + Устанавливает обработчик события на кнопку, а именно проверяет может ли кнопка быть активной, меняет состояние (On/Off) и отправляет Bluetooth команду
  + Сохраняет новое состояние кнопки в тот же SharePreferences
  + Ну и управляет состоянием активных кнопок чтобы несколько кнопок нельзя было активировать
+ onProgressChanged - Это просто обработчик изменения ползунка, также он отправляет текущий уровень яркости в виде команды через OutputStream
+ onStartTrackingTouch - Вызывается когда пользователь начинает взаимодействовать с ползунком, но сам по себе метод пуст
+ onStopTrackingTouch - Вызвается когда пользователь завершает взаимодействие с ползунком и сохраняет текущее значние яркости в SharedPreferenced
+ onStateChanged - Если пользователь пытается перетянуть диалог вниз, он программно возвращает его в развернутое состояние
+ onSlide - Обработчик движения BottomSheet вверх/вниз, но все равно он не используется, не было придумано нормальное применение

## ModeController.java ##

Это класс в котором храняться все режимы находящиеся в всполывающем меню "Режимы" - layout_bottom_sheet.xml\
Каждый из методов посылает свою команду в outputStream. Среди методов следующие методы:
+ ModeController - Конструктор класса
+ toogleStripBlink - метод для мигания
+ toogleFadeEffect - метод для затухания и оттухания диодов
+ tooglePhonkEffect - метод для режима фонк с беспорядочным (почти) миганием
+ toogleSos - метод для воспроизведения на азбуке морза SOS
+ toogleColorCycle - метод для режима Flash с изменением цветов
+ toogleStrobe - метод с быстрым миганием
+ toogleCold - метод для затухания синиго цвета
+ toogleRomantic - метод для двойного мигания и паузы
+ toogleRelax - метод для спокойного времяприпровождения
+ toogleChill - метод с разноообразным переключением диодов
+ toogleEpileptics - метод с супербыстрым миганием
+ tooglePolice - метод для режима мигалок полиццейского авто

## MainActivity ##

### Создание Activity ###
+ Функция onCreate
  + Проверка поддержки Bluetooth на устройстве
  + Запрос разрешений для использования Bluetooth и доступа к метостоположению
  + Настройка пользовательского интерфейса:
    + Привязываем кнопки
    + Инициализируем события OnClickListener
    + Анимация интерфейса
  + Создание объектов MenuDialog

### Из основных функцию выделю следующие: ###
+ toogleLED() - эта функция для повышения яркости в самом приложении. Было создано чтобы если человек в темноте решил включить приложение, то его не ослепит благодаря изначально темному экрану, который можно переключить на светлый
+ Функции fadeInLightEffect и fadeOutLightEffect - создают анимацию постепенного эффекта увеличиения яркости экрана
+ animateButtonIn - Анимирует последовательное появление кнопок на главном экране

### Работа с Bluetooth ###

#### enableBluetooth ####

Этот метод проверяет, включен ли bluetooth на устройтве. Если он отключен, то включится автоматически.

#### connectBluetoothDevice ####

Подлючается к заранеее заданному Bluetooth устройству по его MAC адресу.
+ Создает Bluetooth сокет
+ Устанавиливает соединение через mSocket.connect()
+ Получает поток вывода mOutputStream, который будет использоваться для отправлки данных на устройство
+ Создает объект ModeController для управления нашими режимами работы устройства

### Управление Bluetooth устройством ###

#### showBottomSheet() ####

Показывает окно нижнего листа с переключателями режимов
+ Загружает состояния кнопок из SharedPreferences
+ Реализует механизхм взаимной блокировки кнопок
+ При нажатии на кнопку вызывает метод объект ModeController

#### handleButtonPress ####

Обрабатывает нажатия кнопок нижнего листа
+ Сохраняет состояние кнопок в SharedPreferences
+ Активирует или деактивирует режим
+ Показывает сообщение, что bluetooth не подключен

### Жизненный цикл Activity ###

#### onDestroy ####

Закрывает Bluetooth сокет mSocket во время разрушения Activity чтобы избежать утечек ресурсов и данных
